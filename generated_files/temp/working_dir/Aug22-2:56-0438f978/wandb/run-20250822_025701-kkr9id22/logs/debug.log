2025-08-22 02:57:01,162 INFO    MainThread:90131 [wandb_setup.py:_flush():70] Current SDK version is 0.19.11
2025-08-22 02:57:01,162 INFO    MainThread:90131 [wandb_setup.py:_flush():70] Configure stats pid to 90131
2025-08-22 02:57:01,162 INFO    MainThread:90131 [wandb_setup.py:_flush():70] Loading settings from /home/zhuowei/.config/wandb/settings
2025-08-22 02:57:01,162 INFO    MainThread:90131 [wandb_setup.py:_flush():70] Loading settings from /home/zhuowei/MyProj/G-Align-v2/G-Align-v2/wandb/settings
2025-08-22 02:57:01,162 INFO    MainThread:90131 [wandb_setup.py:_flush():70] Loading settings from environment variables
2025-08-22 02:57:01,162 INFO    MainThread:90131 [wandb_init.py:setup_run_log_directory():724] Logging user logs to /home/zhuowei/MyProj/G-Align-v2/G-Align-v2/generated_files/temp/working_dir/Aug22-2:56-0438f978/wandb/run-20250822_025701-kkr9id22/logs/debug.log
2025-08-22 02:57:01,162 INFO    MainThread:90131 [wandb_init.py:setup_run_log_directory():725] Logging internal logs to /home/zhuowei/MyProj/G-Align-v2/G-Align-v2/generated_files/temp/working_dir/Aug22-2:56-0438f978/wandb/run-20250822_025701-kkr9id22/logs/debug-internal.log
2025-08-22 02:57:01,162 INFO    MainThread:90131 [wandb_init.py:init():852] calling init triggers
2025-08-22 02:57:01,163 INFO    MainThread:90131 [wandb_init.py:init():857] wandb.init called with sweep_config: {}
config: {'project_root': '/home/zhuowei/MyProj/G-Align-v2/G-Align-v2', 'dirs': {'data_storage': '/home/zhuowei/MyProj/G-Align-v2/G-Align-v2/datasets/', 'hydra': '/home/zhuowei/MyProj/G-Align-v2/G-Align-v2/generated_files/temp/working_dir/Aug22-2:56-0438f978/hydra/', 'output': '/home/zhuowei/MyProj/G-Align-v2/G-Align-v2/generated_files/output/G-Align/Aug22-2:56-0438f978/', 'fingerprint_storage': '/home/zhuowei/MyProj/G-Align-v2/G-Align-v2/generated_files/fingerprint/', 'checkpoint_dir': '/home/zhuowei/MyProj/G-Align-v2/G-Align-v2/generated_files/checkpoints/G-Align/Aug22-2:56-0438f978/', 'temp': '/home/zhuowei/MyProj/G-Align-v2/G-Align-v2/generated_files/temp/working_dir/Aug22-2:56-0438f978/'}, 'res_file': '/home/zhuowei/MyProj/G-Align-v2/G-Align-v2/generated_files/output/G-Align/Aug22-2:56-0438f978/seed0_results.json', 'uid': 'Aug22-2:56-0438f978', 'seed': 0, 'remove_dir': False, 'pretrain': {'seed': 42, 'gpu': 1, 'pretrain_datasets': ['pubmed', 'arxiv', 'wikics', 'amazon-ratings'], 'train_tasks': ['pubmed_link', 'pubmed_node', 'arxiv', 'wikics', 'amazon-ratings'], 'eval_tasks': ['cora_node'], 'use_original_mask': False, 'pretrain_epochs': 6000, 'k_shot': 5, 'm_way': 10, 't_query': 1, 'n_eqisodes': 100, 'min_delta': 0.001, 'patience': 10000, 'log_every_n_steps': 1, 'check_val_every_n_epoch': 5, 'pretrain_tasks': ['pubmed_link', 'pubmed_node', 'arxiv', 'wikics', 'amazon-ratings']}, 'wandb': {'project': 'GAlign-Pretrain-Ali', 'debug': False}, 'logging': {'level': 'info', 'enable_stdout_log': True, 'log_wandb_metric_to_stdout': False, 'prefix': ''}, 'preprocess_device': 'gpu', 'dataset': 'Debug', 'train_datasets': 'Debug', 'eval_datasets': 'Debug', 'task_names': ['cora_link', 'cora_node', 'pubmed_link', 'pubmed_node', 'arxiv', 'WN18RR', 'FB15K237', 'wikics', 'chemblpre', 'chempcba', 'chemhiv'], 'llm_name': 'ST', 'llm_b_size': 1, 'batch_size': 512, 'train_sample_size': -1, '_all_datasets': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings'], '_dataset_lookup': {'Xcora': {'eval': ['cora'], 'train': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings']}, 'Xpubmed': {'eval': ['pubmed'], 'train': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings']}, 'Xarxiv': {'eval': ['arxiv'], 'train': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings']}, 'Xwikics': {'eval': ['wikics'], 'train': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings']}, 'XWN18RR': {'eval': ['WN18RR'], 'train': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings']}, 'XFB15K237': {'eval': ['FB15K237'], 'train': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings']}, 'Xchemhiv': {'eval': ['chemhiv'], 'train': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings']}, 'Xchemblpre': {'eval': ['chemblpre'], 'train': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings']}, 'Xchempcba': {'eval': ['chempcba'], 'train': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings']}}, 'data_config': {'E2E-node': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'arxiv': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 40}, 'logic_arxiv': {'task_level': 'logic_e2e', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'auc', 'eval_func': 'flat_auc', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivSplitter', 'process_label_func': 'process_logic_label', 'num_classes': 40}, 'cora': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'Cora', 'dataset_splitter': 'CiteSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'logic_cora': {'task_level': 'logic_e2e', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'auc', 'eval_func': 'flat_auc', 'eval_mode': 'max', 'dataset_name': 'Cora', 'dataset_splitter': 'CiteSplitter', 'process_label_func': 'process_logic_label', 'num_classes': 7}, 'pubmed': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'pubmed', 'dataset_splitter': 'CiteSplitter', 'process_label_func': 'process_int_label', 'num_classes': 3}, 'wikics': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'wikics', 'dataset_splitter': 'WikiSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 10}, 'amazon-ratings': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'amazon-ratings', 'dataset_splitter': 'AmazonRatingsSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'link-eval-args': {'remove_edge': False, 'walk_length': None}, 'E2E-link': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}}, 'E2E-link-cite': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max'}, 'cora_link': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'Cora'}, 'cora_link_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'Cora'}, 'pubmed_link': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'pubmed'}, 'pubmed_link_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'pubmed'}, 'E2E-link-KG': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'WN18RR': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'num_classes': 11}, 'WN18RR_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'num_classes': 11}, 'FB15K237': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'num_classes': 237}, 'FB15K237_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'num_classes': 237}, 'E2E-graph': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max'}, 'chemblpre': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chemblpre', 'process_label_func': 'process_positive_negative_multi_label', 'eval_metric': 'apr', 'eval_func': 'binary_apr_func', 'num_classes': 1295}, 'chempcba': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chempcba', 'process_label_func': 'process_positive_negative_multi_label', 'eval_metric': 'apr', 'eval_func': 'binary_apr_func', 'num_classes': 128}, 'chempcba_eval': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chempcba', 'process_label_func': 'process_label_positive_only', 'eval_metric': 'apr', 'eval_func': 'binary_apr_func', 'num_classes': 128}, 'chemhiv': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chemhiv', 'process_label_func': 'process_reverse_binary_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2}, 'LR-node': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'arxiv_fs': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 5, 'min_k_shot': 0, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'arxiv_fs_51': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'arxiv_fs_53': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 3, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'arxiv_fs_55': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 5, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'cora_fs': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_21': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_23': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 3, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_25': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 5, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_71': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 7, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'cora_fs_73': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 7, 'k_shot': 3, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'cora_fs_75': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 7, 'k_shot': 5, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'LR-link': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'FB15K237_fs': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 5, 'min_k_shot': 1, 'min_n_way': 10, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'FB15K237_fs_101': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 10, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 10}, 'FB15K237_fs_103': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 10, 'k_shot': 3, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 10}, 'FB15K237_fs_105': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 10, 'k_shot': 5, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 10}, 'FB15K237_fs_201': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'FB15K237_fs_203': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 3, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'FB15K237_fs_205': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 5, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'WN18RR_fs': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'WN18RR_fs_51': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'WN18RR_fs_53': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 3, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'WN18RR_fs_55': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 5, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}}, '_ds_meta_data': {'cora': 'pyg, Planetoid.Cora', 'pubmed': 'pyg, Planetoid.PubMed', 'arxiv': 'ofa, SingleTextGraph.arxiv', 'wikics': 'ofa, SingleTextGraph.WikiCS', 'amazon-ratings': 'pyg, HeterophilousGraphDataset.Amazon-ratings', 'fb15k237': 'ofa, KnowledgeGraph.FB15K237', 'wn18rr': 'ofa, KnowledgeGraph.WN18RR'}, 'model': {'name': 'G-Align'}, 'prev_ckpt': None, 'unify_dim': 64, 'Fingerprint': {'hidden_dim': 64, 'n_layers': 1, 'conv_type': 'SAGE', 'add_self_loops': True, 'n_layers_fingerprint': 1, 'n_heads': 8, 'use_bn': False, 'probe_lr': 0.01, 'fp_proj_dim': 64, 'dropout': 0.5, 'readout_proj': True, 'task': 'node_cls', 'device': None, 'require_grad_only': True, 'compressed_dim': 64, 'pca_whiten': True, 'pca_svd_full': False, 'l2_normalize': True, 'random_state': 42, 'loss_type': 'ce', 'DE_type': 'conv', 'contrast_loss': {'probe_mask_ratio': 0.3, 'probe_recon_weight': 1.0, 'probe_neigh_weight': 1.0, 'detach_embed': True}, 'DE': {'hidden_channels': 32, 'num_conv_layers': 2, 'kernel_size': 3, 'padding': 1, 'use_maxpool': True, 'pool_size': 2, 'pool_stride': 2, 'adaptive_pool_size': 4, 'mlp_hidden_dims': [256, 128], 'mlp_dropout': 0.2, 'train_epochs': 300, 'train_lr': 0.001, 'diversity_weight': 0.1, 'padding_strategy': 'zero', 'padding_noise_std': 0.01}}, 'FiLM': {'hidden_dim': 64, 'num_layers': 2, 'aligned_feat_dim': 64, 'dropout': 0.5, 'layernorm': False, 'softplus': True}, 'PAMA': {'d_attn': 64, 'heads': 1, 'dropout': 0.5}, 'PTModel': {'lr': 0.01, 'weight_decay': 5e-05}, '_wandb': {}}
2025-08-22 02:57:01,163 INFO    MainThread:90131 [wandb_init.py:init():893] starting backend
2025-08-22 02:57:01,163 INFO    MainThread:90131 [wandb_init.py:init():897] sending inform_init request
2025-08-22 02:57:01,167 INFO    MainThread:90131 [backend.py:_multiprocessing_setup():101] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-08-22 02:57:01,167 INFO    MainThread:90131 [wandb_init.py:init():907] backend started and connected
2025-08-22 02:57:01,174 INFO    MainThread:90131 [wandb_init.py:init():1005] updated telemetry
2025-08-22 02:57:01,179 INFO    MainThread:90131 [wandb_init.py:init():1029] communicating run to backend with 90.0 second timeout
2025-08-22 02:57:02,274 INFO    MainThread:90131 [wandb_init.py:init():1104] starting run threads in backend
2025-08-22 02:57:02,742 INFO    MainThread:90131 [wandb_run.py:_console_start():2573] atexit reg
2025-08-22 02:57:02,742 INFO    MainThread:90131 [wandb_run.py:_redirect():2421] redirect: wrap_raw
2025-08-22 02:57:02,743 INFO    MainThread:90131 [wandb_run.py:_redirect():2490] Wrapping output streams.
2025-08-22 02:57:02,743 INFO    MainThread:90131 [wandb_run.py:_redirect():2513] Redirects installed.
2025-08-22 02:57:02,746 INFO    MainThread:90131 [wandb_init.py:init():1150] run started, returning control to user process
2025-08-22 02:57:03,085 INFO    MainThread:90131 [wandb_run.py:_config_callback():1436] config_cb None None {'cfg': "{'project_root': '${hydra:runtime.cwd}', 'dirs': {'data_storage': '${project_root}/datasets/', 'hydra': '${.temp}hydra/', 'output': '${project_root}/generated_files/output/${model.name}/${uid}/', 'fingerprint_storage': '${project_root}/generated_files/fingerprint/', 'checkpoint_dir': '${project_root}/generated_files/checkpoints/${model.name}/${uid}/', 'temp': '${project_root}/generated_files/temp/working_dir/${uid}/'}, 'res_file': '${dirs.output}seed${seed}_results.json', 'uid': 'Aug22-2:56-0438f978', 'seed': 0, 'remove_dir': False, 'pretrain': {'seed': 42, 'gpu': 1, 'pretrain_datasets': ['pubmed', 'arxiv', 'wikics', 'amazon-ratings'], 'train_tasks': ['pubmed_link', 'pubmed_node', 'arxiv', 'wikics', 'amazon-ratings'], 'eval_tasks': ['cora_node'], 'use_original_mask': False, 'pretrain_epochs': 6000, 'k_shot': 5, 'm_way': 10, 't_query': 1, 'n_eqisodes': 100, 'min_delta': 0.001, 'patience': 10000, 'log_every_n_steps': 1, 'check_val_every_n_epoch': 5, 'pretrain_tasks': ['pubmed_link', 'pubmed_node', 'arxiv', 'wikics', 'amazon-ratings']}, 'wandb': {'project': 'GAlign-Pretrain-Ali', 'debug': False}, 'logging': {'level': 'info', 'enable_stdout_log': True, 'log_wandb_metric_to_stdout': False, 'prefix': ''}, 'preprocess_device': 'gpu', 'dataset': 'Debug', 'train_datasets': '${oc.select:_dataset_lookup.${dataset}.train,${dataset}}', 'eval_datasets': '${oc.select:_dataset_lookup.${dataset}.eval,${dataset}}', 'task_names': ['cora_link', 'cora_node', 'pubmed_link', 'pubmed_node', 'arxiv', 'WN18RR', 'FB15K237', 'wikics', 'chemblpre', 'chempcba', 'chemhiv'], 'llm_name': 'ST', 'llm_b_size': 1, 'batch_size': 512, 'train_sample_size': -1, '_all_datasets': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings'], '_dataset_lookup': {'Xcora': {'eval': ['cora'], 'train': '${_all_datasets}'}, 'Xpubmed': {'eval': ['pubmed'], 'train': '${_all_datasets}'}, 'Xarxiv': {'eval': ['arxiv'], 'train': '${_all_datasets}'}, 'Xwikics': {'eval': ['wikics'], 'train': '${_all_datasets}'}, 'XWN18RR': {'eval': ['WN18RR'], 'train': '${_all_datasets}'}, 'XFB15K237': {'eval': ['FB15K237'], 'train': '${_all_datasets}'}, 'Xchemhiv': {'eval': ['chemhiv'], 'train': '${_all_datasets}'}, 'Xchemblpre': {'eval': ['chemblpre'], 'train': '${_all_datasets}'}, 'Xchempcba': {'eval': ['chempcba'], 'train': '${_all_datasets}'}}, 'data_config': {'E2E-node': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'arxiv': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 40}, 'logic_arxiv': {'task_level': 'logic_e2e', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'auc', 'eval_func': 'flat_auc', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivSplitter', 'process_label_func': 'process_logic_label', 'num_classes': 40}, 'cora': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'Cora', 'dataset_splitter': 'CiteSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'logic_cora': {'task_level': 'logic_e2e', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'auc', 'eval_func': 'flat_auc', 'eval_mode': 'max', 'dataset_name': 'Cora', 'dataset_splitter': 'CiteSplitter', 'process_label_func': 'process_logic_label', 'num_classes': 7}, 'pubmed': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'pubmed', 'dataset_splitter': 'CiteSplitter', 'process_label_func': 'process_int_label', 'num_classes': 3}, 'wikics': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'wikics', 'dataset_splitter': 'WikiSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 10}, 'amazon-ratings': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'amazon-ratings', 'dataset_splitter': 'AmazonRatingsSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'link-eval-args': {'remove_edge': False, 'walk_length': None}, 'E2E-link': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}}, 'E2E-link-cite': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max'}, 'cora_link': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'Cora'}, 'cora_link_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'Cora'}, 'pubmed_link': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'pubmed'}, 'pubmed_link_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'pubmed'}, 'E2E-link-KG': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'WN18RR': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'num_classes': 11}, 'WN18RR_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'num_classes': 11}, 'FB15K237': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'num_classes': 237}, 'FB15K237_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'num_classes': 237}, 'E2E-graph': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max'}, 'chemblpre': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chemblpre', 'process_label_func': 'process_positive_negative_multi_label', 'eval_metric': 'apr', 'eval_func': 'binary_apr_func', 'num_classes': 1295}, 'chempcba': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chempcba', 'process_label_func': 'process_positive_negative_multi_label', 'eval_metric': 'apr', 'eval_func': 'binary_apr_func', 'num_classes': 128}, 'chempcba_eval': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chempcba', 'process_label_func': 'process_label_positive_only', 'eval_metric': 'apr', 'eval_func': 'binary_apr_func', 'num_classes': 128}, 'chemhiv': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chemhiv', 'process_label_func': 'process_reverse_binary_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2}, 'LR-node': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'arxiv_fs': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 5, 'min_k_shot': 0, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'arxiv_fs_51': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'arxiv_fs_53': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 3, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'arxiv_fs_55': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 5, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'cora_fs': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_21': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_23': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 3, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_25': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 5, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_71': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 7, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'cora_fs_73': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 7, 'k_shot': 3, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'cora_fs_75': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 7, 'k_shot': 5, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'LR-link': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'FB15K237_fs': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 5, 'min_k_shot': 1, 'min_n_way': 10, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'FB15K237_fs_101': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 10, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 10}, 'FB15K237_fs_103': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 10, 'k_shot': 3, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 10}, 'FB15K237_fs_105': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 10, 'k_shot': 5, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 10}, 'FB15K237_fs_201': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'FB15K237_fs_203': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 3, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'FB15K237_fs_205': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 5, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'WN18RR_fs': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'WN18RR_fs_51': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'WN18RR_fs_53': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 3, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'WN18RR_fs_55': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 5, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}}, '_ds_meta_data': {'cora': 'pyg, Planetoid.Cora', 'pubmed': 'pyg, Planetoid.PubMed', 'arxiv': 'ofa, SingleTextGraph.arxiv', 'wikics': 'ofa, SingleTextGraph.WikiCS', 'amazon-ratings': 'pyg, HeterophilousGraphDataset.Amazon-ratings', 'fb15k237': 'ofa, KnowledgeGraph.FB15K237', 'wn18rr': 'ofa, KnowledgeGraph.WN18RR'}, 'model': {'name': 'G-Align'}, 'prev_ckpt': None, 'unify_dim': 64, 'Fingerprint': {'hidden_dim': 64, 'n_layers': 1, 'conv_type': 'SAGE', 'add_self_loops': True, 'n_layers_fingerprint': 1, 'n_heads': 8, 'use_bn': False, 'probe_lr': 0.01, 'fp_proj_dim': 64, 'dropout': 0.5, 'readout_proj': True, 'task': 'node_cls', 'device': None, 'require_grad_only': True, 'compressed_dim': 64, 'pca_whiten': True, 'pca_svd_full': False, 'l2_normalize': True, 'random_state': 42, 'loss_type': 'ce', 'DE_type': 'conv', 'contrast_loss': {'probe_mask_ratio': 0.3, 'probe_recon_weight': 1.0, 'probe_neigh_weight': 1.0, 'detach_embed': True}, 'DE': {'hidden_channels': 32, 'num_conv_layers': 2, 'kernel_size': 3, 'padding': 1, 'use_maxpool': True, 'pool_size': 2, 'pool_stride': 2, 'adaptive_pool_size': 4, 'mlp_hidden_dims': [256, 128], 'mlp_dropout': 0.2, 'train_epochs': 300, 'train_lr': 0.001, 'diversity_weight': 0.1, 'padding_strategy': 'zero', 'padding_noise_std': 0.01}}, 'FiLM': {'hidden_dim': 64, 'num_layers': 2, 'aligned_feat_dim': 64, 'dropout': 0.5, 'layernorm': False, 'softplus': True}, 'PAMA': {'d_attn': 64, 'heads': 1, 'dropout': 0.5}, 'PTModel': {'lr': 0.01, 'weight_decay': 5e-05}}", 'L_max': 58}
2025-08-23 23:41:25,521 INFO    MainThread:90131 [wandb_run.py:_config_callback():1436] config_cb None None {'cfg': "{'project_root': '${hydra:runtime.cwd}', 'dirs': {'data_storage': '${project_root}/datasets/', 'hydra': '${.temp}hydra/', 'output': '${project_root}/generated_files/output/${model.name}/${uid}/', 'fingerprint_storage': '${project_root}/generated_files/fingerprint/', 'checkpoint_dir': '${project_root}/generated_files/checkpoints/${model.name}/${uid}/', 'temp': '${project_root}/generated_files/temp/working_dir/${uid}/'}, 'res_file': '${dirs.output}seed${seed}_results.json', 'uid': 'Aug22-2:56-0438f978', 'seed': 0, 'remove_dir': False, 'pretrain': {'seed': 42, 'gpu': 1, 'pretrain_datasets': ['pubmed', 'arxiv', 'wikics', 'amazon-ratings'], 'train_tasks': ['pubmed_link', 'pubmed_node', 'arxiv', 'wikics', 'amazon-ratings'], 'eval_tasks': ['cora_node'], 'use_original_mask': False, 'pretrain_epochs': 6000, 'k_shot': 5, 'm_way': 10, 't_query': 1, 'n_eqisodes': 100, 'min_delta': 0.001, 'patience': 10000, 'log_every_n_steps': 1, 'check_val_every_n_epoch': 5, 'pretrain_tasks': ['pubmed_link', 'pubmed_node', 'arxiv', 'wikics', 'amazon-ratings']}, 'wandb': {'project': 'GAlign-Pretrain-Ali', 'debug': False}, 'logging': {'level': 'info', 'enable_stdout_log': True, 'log_wandb_metric_to_stdout': False, 'prefix': ''}, 'preprocess_device': 'gpu', 'dataset': 'Debug', 'train_datasets': '${oc.select:_dataset_lookup.${dataset}.train,${dataset}}', 'eval_datasets': '${oc.select:_dataset_lookup.${dataset}.eval,${dataset}}', 'task_names': ['cora_link', 'cora_node', 'pubmed_link', 'pubmed_node', 'arxiv', 'WN18RR', 'FB15K237', 'wikics', 'chemblpre', 'chempcba', 'chemhiv'], 'llm_name': 'ST', 'llm_b_size': 1, 'batch_size': 512, 'train_sample_size': -1, '_all_datasets': ['cora', 'pubmed', 'arxiv', 'wikics', 'amazon-ratings'], '_dataset_lookup': {'Xcora': {'eval': ['cora'], 'train': '${_all_datasets}'}, 'Xpubmed': {'eval': ['pubmed'], 'train': '${_all_datasets}'}, 'Xarxiv': {'eval': ['arxiv'], 'train': '${_all_datasets}'}, 'Xwikics': {'eval': ['wikics'], 'train': '${_all_datasets}'}, 'XWN18RR': {'eval': ['WN18RR'], 'train': '${_all_datasets}'}, 'XFB15K237': {'eval': ['FB15K237'], 'train': '${_all_datasets}'}, 'Xchemhiv': {'eval': ['chemhiv'], 'train': '${_all_datasets}'}, 'Xchemblpre': {'eval': ['chemblpre'], 'train': '${_all_datasets}'}, 'Xchempcba': {'eval': ['chempcba'], 'train': '${_all_datasets}'}}, 'data_config': {'E2E-node': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'arxiv': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 40}, 'logic_arxiv': {'task_level': 'logic_e2e', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'auc', 'eval_func': 'flat_auc', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivSplitter', 'process_label_func': 'process_logic_label', 'num_classes': 40}, 'cora': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'Cora', 'dataset_splitter': 'CiteSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'logic_cora': {'task_level': 'logic_e2e', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'auc', 'eval_func': 'flat_auc', 'eval_mode': 'max', 'dataset_name': 'Cora', 'dataset_splitter': 'CiteSplitter', 'process_label_func': 'process_logic_label', 'num_classes': 7}, 'pubmed': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'pubmed', 'dataset_splitter': 'CiteSplitter', 'process_label_func': 'process_int_label', 'num_classes': 3}, 'wikics': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'wikics', 'dataset_splitter': 'WikiSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 10}, 'amazon-ratings': {'task_level': 'e2e_node', 'preprocess': None, 'construct': 'ConstructNodeCls', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'amazon-ratings', 'dataset_splitter': 'AmazonRatingsSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'link-eval-args': {'remove_edge': False, 'walk_length': None}, 'E2E-link': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}}, 'E2E-link-cite': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max'}, 'cora_link': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'Cora'}, 'cora_link_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'Cora'}, 'pubmed_link': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'pubmed'}, 'pubmed_link_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'preprocess': 'LinkConstructGraph', 'construct': 'ConstructLinkCls', 'dataset_splitter': 'CiteLinkSplitter', 'process_label_func': 'process_int_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2, 'eval_mode': 'max', 'dataset_name': 'pubmed'}, 'E2E-link-KG': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'WN18RR': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'num_classes': 11}, 'WN18RR_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'num_classes': 11}, 'FB15K237': {'task_level': 'e2e_link', 'args': {'remove_edge': True, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'num_classes': 237}, 'FB15K237_eval': {'task_level': 'e2e_link', 'args': {'remove_edge': False, 'walk_length': None}, 'dataset_splitter': 'KGSplitter', 'preprocess': 'KGConstructEdgeList', 'construct': 'ConstructKG', 'process_label_func': 'process_int_label', 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'num_classes': 237}, 'E2E-graph': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max'}, 'chemblpre': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chemblpre', 'process_label_func': 'process_positive_negative_multi_label', 'eval_metric': 'apr', 'eval_func': 'binary_apr_func', 'num_classes': 1295}, 'chempcba': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chempcba', 'process_label_func': 'process_positive_negative_multi_label', 'eval_metric': 'apr', 'eval_func': 'binary_apr_func', 'num_classes': 128}, 'chempcba_eval': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chempcba', 'process_label_func': 'process_label_positive_only', 'eval_metric': 'apr', 'eval_func': 'binary_apr_func', 'num_classes': 128}, 'chemhiv': {'task_level': 'e2e_graph', 'dataset_splitter': 'MolSplitter', 'preprocess': None, 'construct': 'ConstructMolCls', 'args': {'walk_length': None}, 'eval_mode': 'max', 'dataset_name': 'chemhiv', 'process_label_func': 'process_reverse_binary_label', 'eval_metric': 'auc', 'eval_func': 'binary_auc_func', 'num_classes': 2}, 'LR-node': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'arxiv_fs': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 5, 'min_k_shot': 0, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'arxiv_fs_51': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'arxiv_fs_53': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 3, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'arxiv_fs_55': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 5, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'arxiv', 'dataset_splitter': 'ArxivFSSplitter', 'process_label_func': 'process_pth_label', 'num_classes': 5}, 'cora_fs': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_21': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_23': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 3, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_25': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 2, 'k_shot': 5, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 2}, 'cora_fs_71': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 7, 'k_shot': 1, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'cora_fs_73': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 7, 'k_shot': 3, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'cora_fs_75': {'task_level': 'lr_node', 'construct': 'ConstructFSTask', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 7, 'k_shot': 5, 'base_construct': 'ConstructNodeCls', 'no_class_node': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'cora', 'dataset_splitter': 'CiteFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 7}, 'LR-link': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max'}, 'FB15K237_fs': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 5, 'min_k_shot': 1, 'min_n_way': 10, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'FB15K237_fs_101': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 10, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 10}, 'FB15K237_fs_103': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 10, 'k_shot': 3, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 10}, 'FB15K237_fs_105': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 10, 'k_shot': 5, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 10}, 'FB15K237_fs_201': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'FB15K237_fs_203': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 3, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'FB15K237_fs_205': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 20, 'k_shot': 5, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': True}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'FB15K237', 'dataset_splitter': 'KGFSTrainSplitter', 'process_label_func': 'process_int_label', 'num_classes': 20}, 'WN18RR_fs': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'WN18RR_fs_51': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 1, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'WN18RR_fs_53': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 3, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}, 'WN18RR_fs_55': {'task_level': 'lr_link', 'construct': 'ConstructFSTask', 'preprocess': 'KGConstructEdgeList', 'args': {'walk_length': None, 'single_prompt_edge': True, 'n_way': 5, 'k_shot': 5, 'base_construct': 'ConstructKG', 'no_class_node': True, 'remove_edge': False}, 'eval_metric': 'acc', 'eval_func': 'classification_func', 'eval_mode': 'max', 'dataset_name': 'WN18RR', 'dataset_splitter': 'KGFSSplitter', 'process_label_func': 'process_int_label', 'num_classes': 5}}, '_ds_meta_data': {'cora': 'pyg, Planetoid.Cora', 'pubmed': 'pyg, Planetoid.PubMed', 'arxiv': 'ofa, SingleTextGraph.arxiv', 'wikics': 'ofa, SingleTextGraph.WikiCS', 'amazon-ratings': 'pyg, HeterophilousGraphDataset.Amazon-ratings', 'fb15k237': 'ofa, KnowledgeGraph.FB15K237', 'wn18rr': 'ofa, KnowledgeGraph.WN18RR'}, 'model': {'name': 'G-Align'}, 'prev_ckpt': None, 'unify_dim': 64, 'Fingerprint': {'hidden_dim': 64, 'n_layers': 1, 'conv_type': 'SAGE', 'add_self_loops': True, 'n_layers_fingerprint': 1, 'n_heads': 8, 'use_bn': False, 'probe_lr': 0.01, 'fp_proj_dim': 64, 'dropout': 0.5, 'readout_proj': True, 'task': 'node_cls', 'device': None, 'require_grad_only': True, 'compressed_dim': 64, 'pca_whiten': True, 'pca_svd_full': False, 'l2_normalize': True, 'random_state': 42, 'loss_type': 'ce', 'DE_type': 'conv', 'contrast_loss': {'probe_mask_ratio': 0.3, 'probe_recon_weight': 1.0, 'probe_neigh_weight': 1.0, 'detach_embed': True}, 'DE': {'hidden_channels': 32, 'num_conv_layers': 2, 'kernel_size': 3, 'padding': 1, 'use_maxpool': True, 'pool_size': 2, 'pool_stride': 2, 'adaptive_pool_size': 4, 'mlp_hidden_dims': [256, 128], 'mlp_dropout': 0.2, 'train_epochs': 300, 'train_lr': 0.001, 'diversity_weight': 0.1, 'padding_strategy': 'zero', 'padding_noise_std': 0.01}}, 'FiLM': {'hidden_dim': 64, 'num_layers': 2, 'aligned_feat_dim': 64, 'dropout': 0.5, 'layernorm': False, 'softplus': True}, 'PAMA': {'d_attn': 64, 'heads': 1, 'dropout': 0.5}, 'PTModel': {'lr': 0.01, 'weight_decay': 5e-05}}", 'L_max': 58}
2025-08-23 23:41:29,257 INFO    MainThread:90131 [wandb_run.py:_finish():2321] finishing run zhuowei/GAlign-Pretrain-Ali/kkr9id22
2025-08-23 23:41:29,257 INFO    MainThread:90131 [wandb_run.py:_atexit_cleanup():2538] got exitcode: 0
2025-08-23 23:41:29,257 INFO    MainThread:90131 [wandb_run.py:_restore():2520] restore
2025-08-23 23:41:29,258 INFO    MainThread:90131 [wandb_run.py:_restore():2526] restore done
2025-08-23 23:41:31,870 INFO    MainThread:90131 [wandb_run.py:_footer_history_summary_info():4188] rendering history
2025-08-23 23:41:31,871 INFO    MainThread:90131 [wandb_run.py:_footer_history_summary_info():4220] rendering summary
2025-08-23 23:41:31,871 INFO    MainThread:90131 [wandb_run.py:_footer_sync_info():4149] logging synced files
